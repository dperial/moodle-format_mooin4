{"version":3,"sources":["../src/confirm_chapter.js"],"names":["define","$","ModalFactory","String","ModalEvents","Notification","trigger","chapterSectionNumber","chapterIndex","courseIdC","click","event","currentTarget","classList","substring","length","sectionCount","idC","window","parseInt","defaultValue","id","courseid","sectionid","sectionnumber","Y","log","val","create","type","types","CONFIRM","title","get_string","body","preShowCallback","triggerElement","modal","params","large","done","getRoot","on","save","e","preventDefault","location","reload","SAVE_CANCEL","setSaveButtonText","footer","one","setContent","spinner","M","util","add_spinner","show","deletedata","chapterid","ajax","data","url","success","addNotification","message"],"mappings":"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","sourcesContent":["/* eslint-disable camelcase */\r\n// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Delete a chapter in table of content (Chapter content one or many lesson).\r\n *\r\n * @module     format_mooin4/confirm_chapter\r\n * @copyright  2022 Perial Dupont Nguefack Kuaguim\r\n */\r\n\r\ndefine(['jquery', 'core/modal_factory', 'core/str', 'core/modal_events', 'core/notification'],\r\n($, ModalFactory, String, ModalEvents, Notification) => { // Notification\r\n    var trigger = $('.chapter_delete');\r\n\r\n    var chapterSectionNumber = 0;\r\n    var chapterIndex = 0;\r\n    // Var val = 1;\r\n    var courseIdC = '';\r\n    trigger.click(function(event) {\r\n        chapterIndex = event.currentTarget.classList[2].substring(7, event.currentTarget.classList[2].length);\r\n\r\n        let sectionCount = $('.chapter_sectionnumber' + chapterIndex);\r\n        let idC = $('.id_chapter' + chapterIndex);\r\n        // TitleC = $('.chapter_title' + chapterIndex);\r\n        courseIdC = $('.id_course' + chapterIndex);\r\n\r\n        window.chapterSectionNumber = parseInt(sectionCount[0].defaultValue);\r\n        var dataChapter = {};\r\n        dataChapter.id = parseInt(idC[0].defaultValue);\r\n        dataChapter.courseid = parseInt(courseIdC[0].defaultValue);\r\n        // DataChapter.chapter_title = titleC[0].defaultValue;\r\n        dataChapter.sectionid = parseInt(chapterIndex);\r\n        dataChapter.sectionnumber = chapterSectionNumber;\r\n        Y.log(\"1 Chapter section number :\" + window.chapterSectionNumber);\r\n        let val = window.chapterSectionNumber;\r\n        if (val > 0) {\r\n            Y.log(\"Chapter section number > 0:\" + val);\r\n            ModalFactory.create({\r\n                type: ModalFactory.types.CONFIRM,\r\n                title: String.get_string('delete_chapter', 'format_mooin4'), // 'Title delete Section',\r\n                body: String.get_string('chapter_not_empty', 'format_mooin4'),\r\n                preShowCallback: function(triggerElement, modal) {\r\n                    triggerElement = $(triggerElement);\r\n                    modal.params = {\r\n                    'sectionnumber': chapterSectionNumber};\r\n                    // Modal.setSaveButtonText(String.get_string('chapter_okey', 'format_mooin4'));\r\n                    // modal.setCancelButton.dismiss();\r\n                    // modal.setConfirmButtonText(String.get_string('chapter_okey', 'format_mooin4'));\r\n                },\r\n                large: true,\r\n            }, trigger)\r\n            .done(function(modal) {\r\n                modal.getRoot().on(ModalEvents.save, function(e) {\r\n                    e.preventDefault();\r\n                    location.reload();\r\n                });\r\n            });\r\n        }\r\n        if (val == 0) {\r\n            Y.log(\"Chapter section number == 0 :\" + val);\r\n            ModalFactory.create({\r\n                type: ModalFactory.types.SAVE_CANCEL,\r\n                title: String.get_string('delete_chapter', 'format_mooin4'), // 'Title delete Section',\r\n                body: String.get_string('chapter_empty', 'format_mooin4'),\r\n                preShowCallback: function(triggerElement, modal) {\r\n                    triggerElement = $(triggerElement);\r\n                    modal.params = {\r\n                    'courseid': parseInt(courseIdC[0].defaultValue),\r\n                    'chapterid': parseInt(chapterIndex),\r\n                    'sectionnumber': chapterSectionNumber};\r\n                    modal.setSaveButtonText(String.get_string('delete_chapter', 'format_mooin4'));\r\n                },\r\n                large: true,\r\n            }, trigger)\r\n            .done(function(modal) {\r\n                modal.getRoot().on(ModalEvents.save, function(e) {\r\n                    e.preventDefault();\r\n                    let footer = Y.one('.modal-footer');\r\n                    footer.setContent('Deleting chapter...');\r\n                    let spinner = M.util.add_spinner(Y, footer);\r\n                    spinner.show();\r\n                    Y.log(modal.params);\r\n                    var deletedata = {};\r\n                    deletedata.courseid = modal.params.courseid;\r\n                    deletedata.chapterid = modal.params.chapterid;\r\n                    deletedata.sectionnumber = modal.params.sectionnumber;\r\n                    $.ajax({\r\n                        type: 'POST',\r\n                        data: deletedata,\r\n                        url: 'delete_chapter.php',\r\n                        success: (deletedata) => {\r\n                            Y.log(deletedata);\r\n                            Notification.addNotification({\r\n                                message: ' You have successfully deleted the chapter',\r\n                                type: 'success'\r\n                            });\r\n                            window.location.reload();\r\n                        },\r\n                    });\r\n                });\r\n            });\r\n        }\r\n    });\r\n});"],"file":"confirm_chapter.min.js"}