{"version":3,"sources":["../src/confirm_section.js"],"names":["define","$","ModalFactory","String","ModalEvents","Notification","trigger","courseIndex","chapterIndex","sectionIndex","sectionIdUrl","idC","titleC","sectionCount","section_number","click","event","currentTarget","classList","substring","length","url","lastIndexOf","sectionNum","parseInt","defaultValue","create","type","types","SAVE_CANCEL","title","get_string","body","preShowCallback","triggerElement","modal","params","setSaveButtonText","large","done","getRoot","on","save","e","preventDefault","footer","Y","one","setContent","spinner","M","util","add_spinner","show","log","deletedata","courseid","chapterid","sectionid","idchapter","id_chapter","chaptertitle","chapter_title","sectionidurl","section_id_url","sectionnumber","ajax","data","success","addNotification","message","window","location","reload"],"mappings":"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","sourcesContent":["/* eslint-disable camelcase */\r\n// This file is part of Moodle - http://moodle.org/\r\n//\r\n// Moodle is free software: you can redistribute it and/or modify\r\n// it under the terms of the GNU General Public License as published by\r\n// the Free Software Foundation, either version 3 of the License, or\r\n// (at your option) any later version.\r\n//\r\n// Moodle is distributed in the hope that it will be useful,\r\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\r\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\r\n// GNU General Public License for more details.\r\n//\r\n// You should have received a copy of the GNU General Public License\r\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\r\n\r\n/**\r\n * Delete a Section (Lektion) Title in Chapter Card.\r\n *\r\n * @module     format_mooin4/confirm_section\r\n * @copyright  2022 Perial Dupont Nguefack Kuaguim\r\n */\r\n define(['jquery', 'core/modal_factory', 'core/str', 'core/modal_events', 'core/notification'],\r\n    ($, ModalFactory, String, ModalEvents, Notification) => {\r\n    var trigger = $('.section_delete');\r\n    var courseIndex = 0;\r\n    var chapterIndex = 0;\r\n    var sectionIndex = 0;\r\n    // Var chapterSection = 0;\r\n    // Var title = '';\r\n    var sectionIdUrl = 0;\r\n    var idC = 0;\r\n    var titleC = '';\r\n    var sectionCount = 0;\r\n    var section_number = 0;\r\n    trigger.click(function(event) {\r\n        courseIndex = event.currentTarget.classList[0].substring(9, event.currentTarget.classList[0].length);\r\n        chapterIndex = event.currentTarget.classList[1].substring(10, event.currentTarget.classList[1].length);\r\n        sectionIndex = event.currentTarget.classList[2].substring(10, event.currentTarget.classList[2].length);\r\n        // Get the section-id base on the url\r\n        const url = event.currentTarget.classList[3];\r\n\r\n        idC = $('.id_chapter' + chapterIndex);\r\n        titleC = $('.chapter_title' + chapterIndex);\r\n        sectionCount = $('.chapter_sectionnumber' + chapterIndex);\r\n        sectionIdUrl = url.substring(url.lastIndexOf('=') + 1);\r\n        /* Y.log(sectionIdUrl);\r\n        Y.log('CourseIndex : ' + courseIndex);\r\n        Y.log('ChapterIndex : ' + chapterIndex);\r\n        Y.log('SectionIndex : ' + sectionIndex);\r\n        Y.log('id_chapter : ' + parseInt(idC[0].defaultValue));\r\n        Y.log('Sectionnumber : ' + parseInt(sectionCount[0].defaultValue)); */\r\n        const sectionNum = parseInt(sectionCount[0].defaultValue);\r\n        section_number = sectionNum - 1;\r\n\r\n    });\r\n\r\n    ModalFactory.create({\r\n        type: ModalFactory.types.SAVE_CANCEL,\r\n        title: String.get_string('delete_section', 'format_mooin4'), // 'Title delete Section',\r\n        body: '<p> Möchten Sie wirklich diese Lektion löschen ?</p>',\r\n        preShowCallback: function(triggerElement, modal) {\r\n            triggerElement = $(triggerElement);\r\n            modal.params = {\r\n            'courseid': courseIndex,\r\n            'chapterid': chapterIndex,\r\n            'sectionid': sectionIndex,\r\n            'id_chapter': parseInt(idC[0].defaultValue),\r\n            'chapter_title': titleC[0].defaultValue,\r\n            'sectionnumber': section_number,\r\n            'section_id_url': sectionIdUrl};\r\n            modal.setSaveButtonText(String.get_string('delete_section', 'format_mooin4'));\r\n        },\r\n        large: true,\r\n    }, trigger)\r\n    .done(function(modal) {\r\n        modal.getRoot().on(ModalEvents.save, function(e) {\r\n            e.preventDefault();\r\n            let footer = Y.one('.modal-footer');\r\n            footer.setContent('Deleting section...');\r\n            let spinner = M.util.add_spinner(Y, footer);\r\n            spinner.show();\r\n            Y.log(modal.params);\r\n            var deletedata = {};\r\n            deletedata.courseid = modal.params.courseid;\r\n            deletedata.chapterid = modal.params.chapterid;\r\n            deletedata.sectionid = modal.params.sectionid;\r\n            deletedata.idchapter = modal.params.id_chapter;\r\n            deletedata.chaptertitle = modal.params.chapter_title;\r\n            deletedata.sectionidurl = modal.params.section_id_url;\r\n            deletedata.sectionnumber = modal.params.sectionnumber;\r\n            $.ajax({\r\n                type: 'POST',\r\n                data: deletedata,\r\n                url: 'delete_section.php',\r\n                success: (deletedata) => {\r\n                    Y.log(deletedata);\r\n                    Notification.addNotification({\r\n                        message: ' You have successfully deleted the section',\r\n                        type: 'success'\r\n                    });\r\n                    window.location.reload();\r\n                },\r\n            });\r\n            Y.log(deletedata);\r\n        });\r\n    });\r\n });"],"file":"confirm_section.min.js"}